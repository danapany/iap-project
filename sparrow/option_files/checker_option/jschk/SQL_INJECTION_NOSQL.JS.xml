<?xml version="1.0" encoding="utf-8"?>
<option>
    <category name="SQL_INJECTION_NOSQL.JS">
        <item name="taint_source" type="string" required="true" variable="true" regexp="true">
            <value>return of name(reg("\\S+\\.body.*"))</value>
            <value>return of name(reg("\\S+\\.params.*"))</value>
            <value>return of name(reg("\\S+\\.param.*"))</value>
            <value>return of name(reg("\\S+\\.query.*"))</value>
            <value>return of name(reg("\\S+\\.send.*"))</value>
            <value>return of name(reg("\\S+\\.json.*"))</value>
            <value>return of name(reg("\\S+\\.end.*"))</value>
            <value>return of name("body")</value>
            <value>return of name("params")</value>
            <value>return of name("param")</value>
            <value>return of name("query")</value>
            <value>return of name("send")</value>
            <value>return of name("json")</value>
            <value>return of name("end")</value>
            <value>variable of name("$where")</value>
        </item>
        <item name="taint_sink" type="string" required="false" variable="true" regexp="true">
        </item>
        <item name="taint_propagator" type="string" required="false" variable="true" regexp="true">
            <value>operand(*) of name("+") to return</value>
            <value>operand(*) of name("=") to return</value>
            <value>operand(*) of name(":") to return</value>
        </item>
        <item name="taint_filter" type="string" required="false" variable="true" regexp="true">
            <value>return of name("String")</value>
            <value>return of name("toString")</value>
            <!--whitelist!-->
            <value>param(1) of name("indexOf")</value>
            <value>param(1) of name("lastIndexOf")</value>
            <value>param(1) of name("search")</value>
            <value>param(1) of name("includes")</value>
            <value>base of name ("indexOf")</value>
            <value>base of name ("lastIndexOf")</value>
            <value>base of name ("search")</value>
            <value>base of name ("includes")</value>
            <value>operand(*) of name("===")</value>
            <value>operand(*) of name("==")</value>
            <value>operand(*) of name("!==")</value>
            <value>operand(*) of name("!=")</value>
        </item>
        <item name="taint_filter_function_fqn" type="string" required="false" variable="true" regexp="true">
        </item>
    </category>
</option>

